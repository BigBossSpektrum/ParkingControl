{% extends 'app_page/base.html' %}
{% block title %}{% if editar %}Editar Cliente{% else %}Registro de Cliente{% endif %}{% endblock %}
{% block extra_head %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        .card.bg-dark {
            background: linear-gradient(135deg, #111 60%, #0f0 200%);
            border: 2px solid #0f0;
            box-shadow: 0 8px 32px 0 rgba(0,255,0,0.07);
        }
        .form-label {
            color: #0f0;
            font-weight: 500;
        }
        .form-control {
            background: #222;
            color: #0f0;
            border: 1px solid #0f0;
        }
        .form-control:focus {
            background: #111;
            color: #0f0;
            border-color: #0f0;
            box-shadow: 0 0 0 0.2rem rgba(0,255,0,.15);
        }
        .btn-success {
            background: #0f0;
            color: #111;
            border: none;
        }
        .btn-success:hover {
            background: #0c0;
        }
        .btn-dark {
            background: #111;
            color: #0f0;
            border: 1px solid #0f0;
        }
        .btn-dark:hover {
            background: #222;
            color: #0f0;
        }
        .card-title {
            color: #0f0;
            letter-spacing: 1px;
        }
    </style>
{% endblock %}
{% block content %}
<div class="d-flex justify-content-center align-items-center" style="min-height: 80vh;">
    <div class="card bg-dark text-success border-success shadow-lg" style="width: 100%; max-width: 480px;">
        <div class="card-body px-5 py-4">
            <h2 class="card-title text-center mb-4">
                <i class="bi bi-person-plus-fill me-2"></i>{% if editar %}Editar Cliente{% else %}Registro de Cliente{% endif %}
            </h2>
            <form method="post">
                {% csrf_token %}
                {% for field in form.visible_fields %}
                    {% if field.name == 'matricula_inicio' %}
                        <div class="mb-4">
                            <label class="form-label">Matrícula</label>
                            <div class="input-group">
                                <input type="text" name="matricula_inicio" maxlength="3" minlength="3" class="form-control form-control-sm text-uppercase" style="max-width:60px;" value="{{ form.matricula_inicio.value|default_if_none:'' }}" required>
                                <span class="input-group-text" style="max-width:24px;">-</span>
                                <input type="text" name="matricula_fin" maxlength="3" minlength="3" class="form-control form-control-sm text-uppercase" style="max-width:60px;" value="{{ form.matricula_fin.value|default_if_none:'' }}" required>
                            </div>
                            {% if form.matricula_inicio.help_text %}
                                <div class="form-text text-success">{{ form.matricula_inicio.help_text }}</div>
                            {% endif %}
                            {% for error in form.matricula_inicio.errors %}
                                <div class="text-danger small">{{ error }}</div>
                            {% endfor %}
                            {% for error in form.matricula_fin.errors %}
                                <div class="text-danger small">{{ error }}</div>
                            {% endfor %}
                        </div>
                    {% elif field.name != 'tiempo_parking' and field.name != 'matricula_fin' %}
                        <div class="mb-4">
                            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                            {{ field }}
                            {% if field.help_text %}
                                <div class="form-text text-success">{{ field.help_text }}</div>
                            {% endif %}
                            {% for error in field.errors %}
                                <div class="text-danger small">{{ error }}</div>
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endfor %}
                <button type="submit" class="btn btn-success w-100 py-2 mt-2">
                    <i class="bi bi-save me-1"></i>{% if editar %}Guardar Cambios{% else %}Generar Código de Barras{% endif %}
                </button>
            </form>
            <a href="{% url 'lista_clientes' %}" class="btn btn-dark w-100 py-2 mt-3">
                <i class="bi bi-list-ul me-1"></i>Ver lista de clientes
            </a>
        </div>
    </div>
</div>
{% endblock %}
{% block extra_js %}
    {% if message_success %}
        <script>
            Swal.fire({
                icon: 'success',
                title: '{{ message_success }}',
                confirmButtonColor: '#0f0',
                background: '#222',
                color: '#0f0'
            });
        </script>
    {% endif %}
    {% if message_error %}
        <script>
            Swal.fire({
                icon: 'error',
                title: '{{ message_error }}',
                confirmButtonColor: '#0f0',
                background: '#222',
                color: '#0f0'
            });
        </script>
    {% endif %}
{% endblock %}
